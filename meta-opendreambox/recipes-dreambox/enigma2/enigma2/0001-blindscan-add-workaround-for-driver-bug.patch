From d805019fbc215a6149b7f298bedf1751e9d26173 Mon Sep 17 00:00:00 2001
From: ghost <andreas.monzner@dream-property.net>
Date: Fri, 23 Feb 2018 22:31:00 +0100
Subject: [PATCH] blindscan: add workaround for driver bug

---
 usr/lib/enigma2/python/Screens/ScanSetup.py | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/usr/lib/enigma2/python/Screens/ScanSetup.py b/usr/lib/enigma2/python/Screens/ScanSetup.py
index 2fbf999..21113f7 100644
--- a/usr/lib/enigma2/python/Screens/ScanSetup.py
+++ b/usr/lib/enigma2/python/Screens/ScanSetup.py
@@ -960,6 +960,14 @@ class SatelliteTransponderSearchSupport:
 
 				print "CURRENT freq", freq, "%d/%d" %(mhz_done, mhz_complete)
 
+				if not self.driver_wa and tuner_state == stateTuning \
+					and x["tuner_signal_quality_db"] != 0x12345678 \
+					and not x["tuner_synced"]:
+					print "driver stuck workaround!!"
+					self.updateStateTimer.start(1000, True)
+					self.tuneNext()
+					return
+
 				check_finished = self.parm is None
 			else:
 				print "NEXT freq", self.parm.frequency
@@ -1157,6 +1165,13 @@ class SatelliteTransponderSearchSupport:
 			self.parm = self.setNextRange()
 			if self.parm is not None:
 				tparm = eDVBFrontendParameters()
+				if self.auto_scan:
+					# we always do a fake tune on blindscan start to
+					# interrupt a maybe running blindscan with same parameters
+					self.driver_wa = self.parm.symbol_rate
+					self.parm.symbol_rate = 12345000
+					self.parm.is_id = -1
+					tparm = eDVBFrontendParameters()
 				tparm.setDVBS(self.parm, False)
 				self.frontend.tune(tparm)
 				self.start_time = time()
-- 
2.1.4

