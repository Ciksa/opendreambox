From 6141a2bb42ec00d13b3d11f42f746f62fcac1bae Mon Sep 17 00:00:00 2001
From: ghost <andreas.monzner@dream-property.net>
Date: Fri, 16 Aug 2013 12:43:47 +0200
Subject: [PATCH 6/6] HdmiCec: dont send poweron command when a standby request
 is pending or a standby screen is visible

---
 usr/lib/enigma2/python/Plugins/SystemPlugins/HdmiCec/plugin.py | 12 ++----------
 1 file changed, 2 insertions(+), 10 deletions(-)

diff --git a/usr/lib/enigma2/python/Plugins/SystemPlugins/HdmiCec/plugin.py b/usr/lib/enigma2/python/Plugins/SystemPlugins/HdmiCec/plugin.py
index 9a01bea..419ccc8 100644
--- a/usr/lib/enigma2/python/Plugins/SystemPlugins/HdmiCec/plugin.py
+++ b/usr/lib/enigma2/python/Plugins/SystemPlugins/HdmiCec/plugin.py
@@ -9,6 +9,7 @@ config.plugins.cec.sendpower = ConfigEnableDisable(default=True)
 config.plugins.cec.receivepower = ConfigEnableDisable(default=False)
 
 from enigma import getExitCode
+from Tools.Notifications import isPendingOrVisibleNotificationID
 
 class Cec(object):
 	session = None
@@ -53,16 +54,7 @@ def autostart(reason, **kwargs):
 		cec.session = session
 	if reason == 0:
 		if session is not None:
-			from sys import maxint
-			#only send cec power on if it hasn been a record-timer that issued poweron
-			nextRecTime = session.nav.RecordTimer.getNextRecordingTime()
-			if nextRecTime == -1:
-				nextRecTime = maxint
-			nextZapTime = session.nav.RecordTimer.getNextZapTime()
-			if nextZapTime == -1:
-				nextZapTime = maxint
-			wasTimerWakeup = session.nav.wasTimerWakeup()
-			if not wasTimerWakeup or nextZapTime <= nextRecTime:
+			if not isPendingOrVisibleNotificationID("Standby"):
 				cec.powerOn()
 	elif getExitCode() == 1: # send CEC poweroff only on complete box shutdown
 		cec.powerOff()
-- 
1.8.4.rc1

