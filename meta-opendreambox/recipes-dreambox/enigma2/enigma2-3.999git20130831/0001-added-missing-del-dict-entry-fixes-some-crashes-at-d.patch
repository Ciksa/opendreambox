From 4ab85cc0199a2adc9bfe76d135eff3da25bb48b3 Mon Sep 17 00:00:00 2001
From: ghost <andreas.monzner@dream-property.net>
Date: Sun, 1 Sep 2013 01:04:02 +0200
Subject: [PATCH] added missing del dict entry (fixes some crashes at different
 places), add some comments to the code...

---
 lib/python/Screens/Screen.py | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

diff --git a/usr/lib/enigma2/python/Screens/Screen.py b/usr/lib/enigma2/python/Screens/Screen.py
index e330e7b..1a338aa 100644
--- a/usr/lib/enigma2/python/Screens/Screen.py
+++ b/usr/lib/enigma2/python/Screens/Screen.py
@@ -124,13 +124,17 @@ class Screen(dict, GUISkin):
 			val.disconnectAll()  # disconnected converter/sources and probably destroy them. Sources will not be destroyed.
 
 		del self.session
+
+		# we can have multiple dict entries with different names but same Element
+		# but we dont can call destroy multiple times
 		for name in self.keys():
 			val = self[name]
-			if val:
+			del self[name] # remove from dict
+			if val: # is not a duplicate...
 				val.destroy()
-			for (n, v) in self.items():
-				if v == val:
-					self[n] = None
+				for (n, v) in self.items():
+					if v == val: # check if it is the same Element
+						self[n] = None # mark as duplicate
 
 		self.renderer = [ ]
 
-- 
1.8.4.rc3

